<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        body{
            background-image:url(https://raw.githubusercontent.com/NikitonnotikiN/Tune/refs/heads/NikitonnotikiN-patch-1/%D0%91%D0%B5%D0%B7%20%D0%BD%D0%B0%D0%B7%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F284_20260215224953.jpg);
            background-size:cover;
            background-position:center;
            background-repeat:no-repeat;
            color:#fff;
            font-family:Arial,Helvetica,sans-serif;
            height:100vh;
            margin:0;padding:0;
        }

        /* ----------  USER BADGE  ---------- */
        .user-badge{
            position:fixed;
            top:12px; left:12px;
            display:none; align-items:center;
            gap:8px;
            z-index:10000;              /* на 1 шаг выше лоадера */
            background:#0006;
            backdrop-filter:blur(4px);
            padding:6px 12px;
            border-radius:24px;
            font-size:14px
        }
        .user-badge img{
            width:32px; height:32px;
            border-radius:50%; object-fit:cover
        }

        /* ----------  LOADER  ---------- */
        .loader-container{
            position:fixed;
            top:0; left:0; width:100%; height:100%;
            z-index:9999;            /* loader всё-таки ниже бейджа */
            background:#000c; display:flex;
            justify-content:center; align-items:center
        }
        .loader{
            border:16px solid #f3f3f3;
            border-top:16px solid #3498db;
            border-radius:50%;
            width:120px; height:120px;
            animation:spin 2s linear infinite
        }
        @keyframes spin{ from{transform:rotate(0)} to{transform:rotate(360deg)} }

        /* ----------  NAV  ---------- */
        nav ul{
            list-style:none; display:flex;
            gap:20px; padding:0; margin-top:20px;
            justify-content:center
        }
        nav a{
            color:#fff; text-decoration:none;
            padding:10px 20px; border:1px solid #fff;
            border-radius:5px; transition:.3s
        }
        nav a:hover{background:#fff2}
    </style>
</head>
<body>

<!-- Лоадер -->
<div id="loader-container" class="loader-container">
    <div class="loader"></div>
</div>

<!-- Основной контент -->
<section id="content-section" style="display:none">
    <h1>Кирюха спи</h1>
    <nav>
        <ul>
            <li><a href="menu.html">Меню</a></li>
            <li><a href="shop.html">Магазин</a></li>
            <li><a href="garage.html">Гараж</a></li>
            <li><a href="race.html">Заезд</a></li>
            <li><a href="rating.html">Рейтинг</a></li>
        </ul>
    </nav>
</section>

<!-- Бейдж -->
<div id="userBadge" class="user-badge">
    <img id="userAvatar" src="" alt="">
    <span id="userName"></span>
</div>

<script>
/* ----------  USER BADGE  ---------- */
let badgeShown = false;
function showUserBadge(){
    if(badgeShown) return;
    badgeShown = true;

    const user = window.Telegram?.WebApp?.initDataUnsafe?.user;
    if(!user) return;

    const badge  = document.getElementById('userBadge');
    const avatar = document.getElementById('userAvatar');
    const name   = document.getElementById('userName');

    avatar.src = user.photo_url || 'https://i.ibb.co/3sN2YMc/default-ava.png';
    name.textContent = user.first_name || user.username || 'Игрок';
    badge.style.display = 'flex';
}

/* ----------  LOADER & INIT  ---------- */
function startLoader(){
    setTimeout(() => {
        document.getElementById('loader-container').style.display = 'none';
        document.getElementById('content-section').style.display = 'block';

        // готовим Telegram
        if(window.Telegram?.WebApp){
            window.Telegram.WebApp.ready();
            setTimeout(showUserBadge, 150); // даём время на initDataUnsafe
        }
    }, 2000);
}

window.startLoader();   // вызываем сразу
</script>

</body>
</html>
