<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Racing App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        /* ==========  RESET  ========== */
        *{box-sizing:border-box;margin:0;padding:0}

        body{
            background:url(https://raw.githubusercontent.com/NikitonnotikiN/Tune/refs/heads/NikitonnotikiN-patch-1/%D0%91%D0%B5%D0%B7%20%D0%BD%D0%B0%D0%B7%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F284_20260215224953.jpg)
                     center/cover no-repeat #111;
            color:#fff;
            font-family:Arial,Helvetica,sans-serif;
            height:100vh;
            padding-top:60px;          /* отступ под шапку */
        }

        /* ----------  USER BADGE  ---------- */
        .user-badge{
            position:fixed;
            top:12px;left:12px;
            display:flex;align-items:center;gap:8px;
            z-index:10000;
            background:#0006;
            backdrop-filter:blur(4px);
            padding:6px 12px;
            border-radius:24px;
            font-size:14px
        }
        .user-badge img{
            width:32px;height:32px;border-radius:50%;object-fit:cover
        }

        /* ----------  LOADER  ---------- */
        .loader-container{
            position:fixed;
            inset:0;
            z-index:9999;
            background:#000c;
            display:flex;justify-content:center;align-items:center
        }
        .loader{
            border:16px solid #f3f3f3;
            border-top:16px solid #3498db;
            border-radius:50%;
            width:120px;height:120px;
            animation:spin 2s linear infinite
        }
        @keyframes spin{to{transform:rotate(360deg)}}

        /* ----------  NAV  ---------- */
        nav ul{
            list-style:none;display:flex;gap:20px;
            justify-content:center;margin-top:20px
        }
        nav a{
            color:#fff;text-decoration:none;
            padding:10px 20px;border:1px solid #fff;
            border-radius:5px;transition:.3s
        }
        nav a:hover{background:#fff2}

        /* ----------  TG-BUTTONS  ---------- */
        .tg-buttons{
            position:fixed;
            bottom:20px;right:20px;
            display:flex;gap:10px;z-index:1000
        }
        .tg-btn{
            background:#0088cc;color:#fff;border:none;
            padding:10px 18px;border-radius:6px;cursor:pointer
        }
    </style>
</head>
<body>

<!-- ==========  LOADER  ========== -->
<div id="loader-container" class="loader-container">
    <div class="loader"></div>
</div>

<!-- ==========  MAIN  ========== -->
<section id="content-section" style="display:none">
    <h1 style="text-align:center">Кирюха спи</h1>

    <nav>
        <ul>
            <li><a href="menu.html">Меню</a></li>
            <li><a href="shop.html">Магазин</a></li>
            <li><a href="garage.html">Гараж</a></li>
            <li><a href="race.html">Заезд</a></li>
            <li><a href="rating.html">Рейтинг</a></li>
        </ul>
    </nav>
</section>

<!-- ==========  USER BADGE  ========== -->
<div id="userBadge" class="user-badge">
    <img id="userAvatar" src="" alt="">
    <span id="userName">Игрок</span>
</div>

<!-- ==========  TG-BUTTONS  ========== -->
<div class="tg-buttons" id="tgButtons" style="display:none">
    <button class="tg-btn" onclick="shareStory()">Поделиться</button>
    <button class="tg-btn" onclick="closeApp()">✖</button>
</div>

<script>
/* ----------------------------------
   UTILS
---------------------------------- */
const $ = id => document.getElementById(id);

function fillBadge(){
    const user = window.Telegram?.WebApp?.initDataUnsafe?.user;
    if(!user) return;

    $('userAvatar').src = user.photo_url ||
                          'https://i.ibb.co/3sN2YMc/default-ava.png';
    $('userName').textContent = user.first_name ||
                                user.username ||
                                'Игрок';
}

/* ----------------------------------
   LOADER & INIT
---------------------------------- */
function startLoader(){
    setTimeout(() => {
        $('loader-container').style.display = 'none';
        $('content-section').style.display = 'block';

        /* Telegram */
        if(window.Telegram?.WebApp){
            window.Telegram.WebApp.ready();
            fillBadge();               // бейдж
            $('tgButtons').style.display = 'flex'; // показываем кнопки
        }else{
            /* вне Telegram – показываем заглушку */
            $('userName').textContent = 'Offline';
        }
    }, 2000);
}

/* ----------------------------------
   TG ACTIONS
---------------------------------- */
function closeApp(){
    if(window.Telegram?.WebApp) window.Telegram.WebApp.close();
    else window.close();                 // fallback для браузера
}

function shareStory(){
    if(!window.Telegram?.WebApp) return alert('Вне Telegram нельзя');
    const url = window.location.href;
    const text = 'Гоняю в Кирюха-спи!';

    /* WebApp.shareToStory (>=6.10) или shareUrl (старый API) */
    const tg = window.Telegram.WebApp;
    if(typeof tg.shareToStory === 'function'){
        tg.shareToStory(url, {text});
    }else if(tg.shareUrl){
        tg.shareUrl(url, text);
    }else{
        alert('Поделиться не удалось');
    }
}

/* Запускаем */
startLoader();
</script>
</body>
</html>
